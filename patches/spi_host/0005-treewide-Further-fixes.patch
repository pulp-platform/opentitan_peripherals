From 839ed02b61bfad9dfdb5dccd04e2b16db52aeabf Mon Sep 17 00:00:00 2001
From: Paul Scheffler <paulsc@iis.ee.ethz.ch>
Date: Wed, 15 Feb 2023 18:05:51 +0100
Subject: [PATCH] treewide: Further fixes

---
 rtl/spi_host_fsm.sv    | 3 ++-
 rtl/spi_host_window.sv | 4 ++--
 2 files changed, 4 insertions(+), 3 deletions(-)

diff --git a/rtl/spi_host_fsm.sv b/rtl/spi_host_fsm.sv
index c00452795..842a75897 100644
--- a/rtl/spi_host_fsm.sv
+++ b/rtl/spi_host_fsm.sv
@@ -566,7 +566,8 @@ module spi_host_fsm
     end else begin
       unique case (speed_o)
         Standard: begin
-          sd_en_o[0]   = cmd_wr_en;
+          // TODO @paulsc: We fixed this from 1'b1 before; is this fix still valid?
+          sd_en_o[0]   = cmd_wr_en_q;
           sd_en_o[1]   = 1'b0;
           sd_en_o[3:2] = 2'b00;
         end
diff --git a/rtl/spi_host_window.sv b/rtl/spi_host_window.sv
index ffc4f2a71..a10ff9328 100644
--- a/rtl/spi_host_window.sv
+++ b/rtl/spi_host_window.sv
@@ -35,7 +35,7 @@ module spi_host_window #(
   assign rx_access_error = rx_we;
 
   // Check that our RX regbus data is 32 bit wide
-  `ASSERT_INIT(RegbusIs32Bit, $bits(rx_win_i.wdata) == 32)
+  `ASSERT_INIT(RxRegbusIs32Bit, $bits(rx_win_i.wdata) == 32)
 
   // We are already a regbus, so no stateful adapter should be needed here
   // Request
@@ -47,7 +47,7 @@ module spi_host_window #(
   assign rx_win_o.ready  = 1'b1;
 
   // Check that our TX regbus data is 32 bit wide
-  `ASSERT_INIT(RegbusIs32Bit, $bits(tx_win_i.wdata) == 32)
+  `ASSERT_INIT(TxRegbusIs32Bit, $bits(tx_win_i.wdata) == 32)
 
   // We are already a regbus, so no stateful adapter should be needed here
   // Request
-- 
2.16.5

